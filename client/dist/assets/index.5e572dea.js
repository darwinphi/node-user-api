import{j as b,F as x,a as U,b as d,c as f,r as h,u as E,o as L,R as S,d as A}from"./vendor.c31a5688.js";const D=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function s(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerpolicy&&(r.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?r.credentials="include":t.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(t){if(t.ep)return;t.ep=!0;const r=s(t);fetch(t.href,r)}};D();const e=b.exports.jsx,l=b.exports.jsxs,g=b.exports.Fragment,v=({setDisplayEditUser:i,userToEdit:a})=>{console.log("User to edit",a);const s=async t=>{try{const r=await f.put("/users/edit",{id:t.id,email:t.email,firstName:t.firstName,lastName:t.lastName,address:t.address,postcode:t.postcode,contactNumber:t.contactNumber,username:t.username,password:t.password});console.log(r.data),window.location.reload(!1)}catch(r){const{data:c}=r.response.data;alert(c.map(p=>p.msg)),console.log(r)}},n=async t=>{const{firstName:r,lastName:c}=t,p=`Are you sure you want to edit ${r} ${c}?`;confirm(p)&&s(t)};return l(g,{children:[e("p",{children:e("button",{onClick:()=>i(!1),children:"Back"})}),e("h1",{children:"Edit User"}),e(x,{initialValues:{id:a.id,firstName:a.first_name,lastName:a.last_name,username:a.username,address:a.address,postcode:a.postcode,contactNumber:a.contact_number,email:a.email,password:""},onSubmit:async t=>{n(t)},children:l(U,{children:[e("p",{children:e(d,{id:"firstName",name:"firstName",placeholder:"First Name",type:"text",required:!0})}),e("p",{children:e(d,{id:"lastName",name:"lastName",placeholder:"Last Name",type:"text",required:!0})}),e("p",{children:e(d,{id:"username",name:"username",placeholder:"Username",type:"username",required:!0})}),e("p",{children:e(d,{id:"address",name:"address",placeholder:"Address",type:"text",required:!0})}),e("p",{children:e(d,{id:"postcode",name:"postcode",placeholder:"Postcode",type:"text",required:!0})}),e("p",{children:e(d,{id:"contactNumber",name:"contactNumber",placeholder:"Contact No.",type:"text",required:!0})}),e("p",{children:e(d,{id:"email",name:"email",placeholder:"Email",type:"email",required:!0})}),e("p",{children:e(d,{id:"password",name:"password",placeholder:"Password",type:"password",required:!0})}),e("button",{type:"submit",children:"\u{1F4BE} Save"})]})}),e("hr",{})]})},P=({users:i,isAdmin:a})=>{const[s,n]=h.exports.useState(!1),[t,r]=h.exports.useState(null),[c,p]=h.exports.useState([]),u=async o=>{try{const m=await f.delete(`/users/delete/${o}`);console.log(m.data),window.location.reload(!1)}catch(m){console.log(m.response.data.message),alert(m.response.data.message)}},N=async o=>{const{id:m,first_name:y,last_name:w}=o,C=`Are you sure you want to delete ${y} ${w}?`;confirm(C)&&u(m)},k=async()=>{confirm("Are you sure you want to delete the selected users?")&&q()},q=async()=>{try{await f.post("/users/delete",{ids:c}),window.location.reload(!1)}catch(o){console.log(o)}},F=o=>{const m=o.target.value,y=o.target.checked;o.target.checked?(p([...c,m]),console.log("Check and Value",y,m)):p(c.filter(w=>w!==m))};return s?e(v,{setDisplayEditUser:o=>n(o),userToEdit:t}):l(g,{children:[e("h1",{children:"\u{1F468}\u200D\u{1F4BB} Users"}),l("table",{children:[e("thead",{children:l("tr",{children:[e("th",{children:"Name"}),e("th",{children:"Username"}),e("th",{children:"Address"}),e("th",{children:"Postcode"}),e("th",{children:"Contact No."}),e("th",{children:"Email"}),a()&&e("th",{colSpan:2,children:e("button",{onClick:k,children:"Delete All Selected"})})]})}),e("tbody",{children:i&&i.map((o,m)=>l("tr",{children:[l("td",{children:[e("input",{type:"checkbox",value:o.id,onChange:y=>F(y),style:{marginRight:"0.5rem"}}),o.first_name," ",o.last_name]}),e("td",{children:o.username}),e("td",{children:o.address}),e("td",{children:o.postcode}),e("td",{children:o.contact_number}),e("td",{children:o.email}),a()&&l(g,{children:[e("td",{children:e("button",{onClick:()=>{n(!0),r(o)},children:"Edit"})}),e("td",{children:e("button",{onClick:()=>N(o),children:"Delete"})})]})]},m))})]})]})},_=()=>{const i=async s=>{try{const n=await f.post("/users/create",{email:s.email,firstName:s.firstName,lastName:s.lastName,address:s.address,postcode:s.postcode,contactNumber:s.contactNumber,username:s.username,password:s.password,isAdmin:!1});console.log(n.data),window.location.reload(!1)}catch(n){const{data:t}=n.response.data;alert(t.map(r=>r.msg))}},a=async s=>{const{firstName:n,lastName:t}=s,r=`Are you sure you want to create ${n} ${t}?`;confirm(r)&&i(s)};return l(g,{children:[e("h1",{children:"Create User"}),e(x,{initialValues:{firstName:"",lastName:"",username:"",address:"",postcode:"",email:"",password:""},onSubmit:async s=>{a(s)},children:l(U,{children:[e("p",{children:e(d,{id:"firstName",name:"firstName",placeholder:"First Name",type:"text",required:!0})}),e("p",{children:e(d,{id:"lastName",name:"lastName",placeholder:"Last Name",type:"text",required:!0})}),e("p",{children:e(d,{id:"username",name:"username",placeholder:"Username",type:"username",required:!0})}),e("p",{children:e(d,{id:"address",name:"address",placeholder:"Address",type:"text",required:!0})}),e("p",{children:e(d,{id:"postcode",name:"postcode",placeholder:"Postcode",type:"text",required:!0})}),e("p",{children:e(d,{id:"contactNumber",name:"contactNumber",placeholder:"Contact No.",type:"text",required:!0})}),e("p",{children:e(d,{id:"email",name:"email",placeholder:"Email",type:"email",required:!0})}),e("p",{children:e(d,{id:"password",name:"password",placeholder:"Password",type:"password",required:!0})}),e("button",{type:"submit",children:"\u{1F4BE} Save"})]})})]})},$=({setUserToken:i,setLogInErrorMessage:a})=>{const s=async n=>{try{const t=await f.post("/auth/login",{email:n.email,password:n.password}),{data:r}=t.data;i(r.token),console.log("Response",r.token)}catch(t){const{message:r}=t.response.data;console.log(r),a(`\u26D4 ${r}`)}};return e(g,{children:e(x,{initialValues:{email:"",password:""},onSubmit:async n=>{s(n)},children:l(U,{children:[e("p",{children:e(d,{id:"email",name:"email",placeholder:"Email",type:"email",required:!0})}),e("p",{children:e(d,{id:"password",name:"password",placeholder:"Password",type:"password",required:!0})}),e("button",{type:"submit",children:"\u{1F512} Login"})]})})})},B=({onClick:i,value:a})=>e("button",{onClick:i,children:a});function M(){const[i,a]=h.exports.useState(null),[s,n]=E("token",null),[t,r]=h.exports.useState(""),c=()=>s&&L(s).is_admin;return console.log(c()),console.log(i),console.log(s),h.exports.useEffect(async()=>{const u=await f.get("/users"),{data:N}=u.data;a(N)},[]),s?e("main",{children:l("section",{children:[e(B,{onClick:()=>{document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:01 GMT;",window.location.reload(!1)},value:"\u21A9\uFE0F Log Out"}),e(P,{users:i,isAdmin:c}),c()&&e(_,{})]})}):e("main",{children:l("section",{children:[e("h1",{children:"Please Login"}),e("p",{children:t}),e($,{setUserToken:u=>n(u),setLogInErrorMessage:u=>r(u)})]})})}S.render(e(A.StrictMode,{children:e(M,{})}),document.getElementById("root"));
